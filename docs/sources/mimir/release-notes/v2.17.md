---
title: "Grafana Mimir version 2.17 release notes"
menuTitle: "V2.17 release notes"
description: "Release notes for Grafana Mimir version 2.17"
weight: 1100
---

# Grafana Mimir version 2.17 release notes

<!-- vale Grafana.GoogleWill = NO -->
<!-- vale Grafana.Timeless = NO -->
<!-- Release notes are often future focused -->

Grafana Labs is excited to announce version 2.17 of Grafana Mimir.

The highlights that follow include the top features, enhancements, and bug fixes in this release.
For the complete list of changes, refer to the [CHANGELOG](https://github.com/grafana/mimir/blob/main/CHANGELOG.md).

## Features and enhancements

You can enable Mimir Query Engine (MQE) through the experimental CLI flags `-query-frontend.query-engine` or `-query-frontend.enable-query-engine-fallback` or through the corresponding YAML options.

You can export the `cortex_ingester_attributed_active_native_histogram_series` and `cortex_ingester_attributed_active_native_histogram_buckets` native histogram cost attribution metrics to a custom Prometheus registry with user-specified labels.

Grafana Mimir supports converting OTel explicit bucket histograms to Prometheus native histograms with custom buckets using the `distributor.otel-convert-histograms-to-nhcb` flag.

The following experimental features have been removed:

- The `max_cost_attribution_labels_per_user` cost attribution limit
- Read-write deployment mode in the mixin

## Important changes

In Grafana Mimir 2.17, the following behavior has changed:

The Mimir Query Engine (MQE) is enabled by default in queriers. To use the Prometheus engine instead, set `-querier.query-engine=prometheus`.

The following default configuration values now apply to the memberlist KV store:

| Key                                 | Value   |
| ----------------------------------- | ------- |
| `memberlist.packet-dial-timeout`    | `500ms` |
| `memberlist.packet-write-timeout`   | `500ms` |
| `memberlist.max-concurrent-writes`  | `5`     |
| `memberlist.acquire-writer-timeout` | `1s`    |

These values perform better but might cause long-running packets to be dropped in high-latency networks.

The `-ruler-storage.cache.rule-group-enabled` experimental CLI flag has been removed. Caching rule group contents is now always enabled when a cache is configured for the ruler.

The `-ingester.ooo-native-histograms-ingestion-enabled` CLI flag and corresponding `ooo_native_histograms_ingestion_enabled` runtime configuration option have been removed. Out-of-order native histograms are now enabled whenever both native histogram and out-of-order ingestion is enabled.

The `-ingester.stream-chunks-when-using-blocks` CLI flag and corresponding `ingester_stream_chunks_when_using_blocks` runtime configuration option have been deprecated and will be removed in a future release.

The `cortex_distributor_label_values_with_newlines_total` metric has been removed.

## Experimental features

Grafana Mimir 2.17 includes some features that are experimental and disabled by default.
Use these features with caution and report any issues that you encounter:

- Prometheus Remote-Write 2.0 protocol.
- Duration expressions in PromQL. These are simple arithmetics on numbers in offset and range specification.
- Promoting OTel scope metadata, including name, version, schema URL, and attributes, to metric labels, prefixed with `otel_scope_`. Enable this feature through the `-distributor.otel-promote-scope-metadata` flag.
- Allowing primitive delta metrics ingestion through the OTLP endpoint with the `-distributor.otel-native-delta-ingestion` option.
- Support for `sort_by_label` and `sort_by_label_desc` PromQL functions.
- Support for cluster validation in HTTP calls. When enabled, the HTTP server verifies if a request coming from an HTTP client comes from an expected cluster. You can configure this validation with the following options:
  - `-server.cluster-validation.label`
  - `-server.cluster-validation.http.enabled`
  - `-server.cluster-validation.http.soft-validation`
  - `-server.cluster-validation.http.exclude-paths`

## Bug fixes

The following bugs have been fixed:

- OTLP: Fix response body and Content-Type header to align with spec.
- Compactor: Fix issue where a block becomes permanently stuck when the Compactor's block cleanup job partially deletes a block.
- Storage: Fix intermittent failures in S3 upload retries.
- Querier: return `NaN` from `irate()` if the second-to-last sample in the range is `NaN` and Prometheus' query engine is in use.
- Ruler: Don't count alerts towards `cortex_prometheus_notifications_dropped_total` if they are dropped due to alert relabelling.
- Querier: Fix issue where an entire store-gateway zone leaving causes high CPU usage trying to find active members of the leaving zone.
- Query-frontend: Fix blocks retention period enforcement when a request has multiple tenants (tenant federation).
- Query-frontend: Fix `-query-frontend.query-sharding-max-sharded-queries` enforcement for instant queries with binary operators.
- Memberlist: Fix hash ring updates before the full-join has been completed when the `-memberlist.notify-interval` is configured.
- Ingester: Read-reactive limiters should activate and deactivate when the ingester changes state.
- Query-frontend: Fix an issue where errors from date and time parsing methods did not include the name of the invalid parameter.
- Query-frontend: Fix a panic in monolithic mode caused by a clash in labels of the `cortex_client_invalid_cluster_validation_label_requests_total` metric definition.
- Compactor: Fix issue where `MimirBucketIndexNotUpdated` can fire even though the index has been updated within the alert threshold.
- Query-scheduler: Fix issue where deregistered querier goroutines can cause a panic if their backlogged dequeue requests are serviced.
- Ruler: Make failures during the initial sync fatal for the service's startup.
- Querier and query-frontend: Fix issue where aggregation functions like `topk` and `quantile` could return incorrect results if the scalar parameter is not a constant and Prometheus' query engine is in use.
- Querier and query-frontend: Fix issue where range vector selectors could incorrectly ignore samples at the beginning of the range.
- Querier: Fix rare panic if a query is canceled while a request to ingesters or store-gateways has just begun.
- Ruler: Fix `QueryOffset` and `AlignEvaluationTimeOnInterval` being ignored when either recording or alerting rule evaluation is disabled.
- Ruler: Fix rare panic when the ruler is shutting down.
- Block-builder-scheduler: Fix data loss bug in job assignment.
- Compactor: Start tracking `-compactor.max-compaction-time` after the initial compaction planning phase to avoid rare cases where planning takes longer than `-compactor.max-compaction-time` and so actual compaction never runs for a tenant.
- Ingester: Fix issues where ingesters could exit read-only mode during idle and forced compactions, resulting in write errors.
- Mixin: Fix `cluster_namespace_deployment:actual_replicas:count` recording rule when there's a mix of single-zone and multi-zone deployments.
- Mixin: Enhance the `MimirRolloutStuck` alert, so that it checks whether rollout groups as a whole, and not spread across instances, are changing or stuck.
- Jsonnet: Honor `weight` argument when building memory HPA query for resource scaled objects.
- Mimirtool: Fix issue where remote-read doesn't behave like other mimirtool commands for authentication.

### Helm chart improvements

The Grafana Mimir and Grafana Enterprise Metrics Helm chart is released independently.
Refer to the [Grafana Mimir Helm chart documentation](/docs/helm-charts/mimir-distributed/latest/).
